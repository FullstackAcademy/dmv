{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d24c0e4e5e193fbe3a1c","webpack:///./bundle.js","webpack:///./dmv.js","webpack:///./noun.js","webpack:///./afterSetup.js","webpack:///./role.js","webpack:///./nouns.js","webpack:///./nounManager.js","webpack:///./roleManager.js","webpack:///./roles.js","webpack:///./angularPlugin.js","webpack:///./canMixin.js"],"names":["module","exports","require","angular","Noun","Role","RoleManager","NounManager","nouns","roles","addEntity","store","Constructor","name","after","console","warn","Error","get","set","instance","setupRan","_afterSetup","noun","bind","role","getAllNouns","Array","from","values","getNoun","getRole","reset","clear","setTimeout","entities","concat","forEach","setup","BaseClass","constructor","verbs","Set","permissions","v","verb","hasVerb","has","add","removeVerb","delete","authorize","invalidVerbs","filter","length","join","checkAuthorization","AfterSetup","_afterSetupFns","fn","call","push","can","map","Map","r","some","dmv","roleManager","canMixin","factory","proto","extend","$rootScope","$injector","userGetterMethod","asyncUserGetterMethod","canGetUserAsync","getUser","invoke","getUserAsync","e","hasRole","$on","event","next","auth","user","resolve","dmvAuthPromise","Promise","then","forbidden","$broadcast","status","hasOwnProperty","onPermissionsList","list","find","item","permissionsWhiteList","permissionsBlackList","indexOf","isArray"],"mappings":"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","file":"./browser.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dmv\"] = factory();\n\telse\n\t\troot[\"dmv\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d24c0e4e5e193fbe3a1c","'use strict';\n\n// we need to expose the dmv api\nmodule.exports = require('./dmv');\n// angular code just needs to run. it will register module with angular\nif(typeof angular !== 'undefined') {\n  require('./angularPlugin')(angular);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./bundle.js","/**\n * @fileOverview This is the root of the project. It allows users to register nouns and roles with dmv. It also exports plugins.\n * @module main\n * @requires Noun\n * @requires Role\n * @requires RoleManager\n * @requires NounManager\n */\n\n'use strict';\nconst Noun = require('./noun');\nconst Role = require('./role');\n\nconst RoleManager = require('./roleManager');\nconst NounManager = require('./nounManager');\nconst nouns = require('./nouns');\nconst roles = require('./roles');\n\nconst addEntity = function (store, Constructor, name, after) {\n  if (!name) {\n    console.warn(new Error('Entity names cannot be empty'));\n  }\n  if(!store.get(name)) { store.set(name, new Constructor(name)); }\n  const instance = store.get(name);\n  if(this.setupRan) { instance.setupRan = true; }\n  if(after) { instance._afterSetup(after); }\n  return instance;\n};\n\n/**\n * Register a new noun\n * @param  {string} name - noun name\n * @param  {function} after - fn to run after setup. Passed noun instance.\n * @return {noun}       returns noun instance\n */\nexports.noun = addEntity.bind(exports, nouns, Noun);\n\n/**\n * Register a new role\n * @param  {string} name - role name\n * @param  {function} after - fn to run after setup. Passed role instance.\n * @return {role}       returns role instance\n */\nexports.role = addEntity.bind(exports, roles, Role);\n\n/**\n * Gets all registered nouns. Must be called after setup\n * @return {Iterator<Noun>}\n */\nexports.getAllNouns = function() {\n  return Array.from(nouns.values());\n};\n\nexports.getNoun = nouns.get.bind(nouns);\nexports.getRole = roles.get.bind(roles);\n\n/**\n* Empty nouns and roles, resetting dmv. Use with caution.\n*/\nexports.reset = function () {\n  nouns.clear();\n  roles.clear();\n};\n\nsetTimeout(function() {\n  var entities = Array.from(nouns.values()).concat(Array.from(roles.values()));\n  entities.forEach( (instance) => instance.setup() );\n  exports.setupRan = true;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./dmv.js","'use strict';\n\nconst BaseClass = require('./afterSetup');\n/**\n * @class  Noun\n */\n\nclass Noun extends BaseClass {\n  /**\n   * @param  {string} name - name of noun\n   * @return {noun}        - the created noun\n   */\n  constructor(name) {\n    super();\n    this.name = name;\n    this.verbs = new Set();\n    this.permissions = {};\n    ['create','read','update','delete'].forEach( (v) => this.verb(v), this);\n  }\n\n  /**\n   * Checks to see if noun has verb\n   * @param  {string}  verb\n   * @return {Boolean}\n   */\n  hasVerb(verb) {\n    return this.verbs.has(verb);\n  }\n\n  /**\n   * Adds verb to the set of posible verbs that can be authorized. For example, `post.can('like')` would add the verb 'like' to a noun 'post'\n   * @param  {string} verb\n   */\n  verb(verb) {\n    this.verbs.add(verb);\n  }\n\n  /**\n   * Removes a verb from the set of possible verbs. Useful for removing default crud.\n   * @param  {string} verb\n   */\n  removeVerb(verb) {\n    this.verbs.delete(verb);\n  }\n\n  /**\n   * Authorizes a role to perform a verb.\n   * @param  {string} role\n   * @param  {string[]|string} verbs - Either the string '*', which authorizes all possible verbs to the given role, or an array of verbs to authorize.\n   */\n  authorize(role, verbs) {\n    if(verbs === '*') {\n      verbs = this.verbs;\n    } else {\n      let invalidVerbs = verbs.filter(v => !this.verbs.has(v));\n      if (invalidVerbs.length) {\n        console.warn(new Error(`${invalidVerbs.join(',')} are not valid verbs for this noun.`));\n      }\n      verbs = verbs.filter(v => this.verbs.has(v));\n    }\n    this.permissions[role] = this.permissions[role] || new Set();\n    verbs.forEach( (v) => this.permissions[role].add(v) );\n  }\n\n  /**\n   * Checks if a role is regestered and it has the permission\n   * @param  {string} role\n   * @param  {string} verb\n   * @return {boolean}\n   */\n  checkAuthorization(role, verb) {\n    return !!this.permissions[role] && this.permissions[role].has(verb);\n  }\n\n}\n\nmodule.exports = Noun;\n\n\n\n// WEBPACK FOOTER //\n// ./noun.js","'use strict';\n\nmodule.exports = class AfterSetup {\n  constructor() {\n    this._afterSetupFns = [];\n  }\n\n  _afterSetup(fn) {\n    if(this.setupRan) {\n      fn.call(this, this);\n    }\n    this._afterSetupFns.push(fn);\n  }\n\n  setup() {\n    this._afterSetupFns.forEach( (fn) => fn.call(this, this), this);\n    this.setupRan = true;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./afterSetup.js","'use strict';\n\nconst BaseClass = require('./afterSetup');\n/**\n * @class Role\n */\nconst nouns = require('./nouns');\n\nclass Role extends BaseClass{\n  constructor(name) {\n    super();\n    this.name = name;\n  }\n\n  /**\n   * Checks if a given noun can perform a given verb\n   * @function\n   * @example\n   * someRole.can('eat','brick'); // -> true\n   * @param  {string} verb\n   * @param  {string} noun\n   * @return {boolean}\n   */\n  can(verb, noun) {\n    if(!nouns.has(noun)) { return false; }\n    return nouns.get(noun).checkAuthorization(this.name, verb);\n  }\n\n  /**\n   * Authorizes this role to perform an array of actions on a verb\n   * @function\n   * @see  Noun#authorize\n   * @example  someRole.authorize(['create','read'], 'kitten');\n   * @param  {String[]|String} verbs - Either an array of verbs already regestered with the noun, or `'*'` to allow access to all verbs\n   * @param  {String} noun\n   */\n  authorize(verbs, noun) {\n    if(!nouns.has(noun)) { throw new Error(`cannot authorize ${noun}`); }\n    nouns.get(noun).authorize(this.name, verbs);\n  }\n}\n\n\nmodule.exports = Role;\n\n\n\n// WEBPACK FOOTER //\n// ./role.js","'use strict';\n\nconst NounManager = require('./nounManager');\n\nmodule.exports = new NounManager();\n\n\n// WEBPACK FOOTER //\n// ./nouns.js","'use strict';\n\n/** @todo  extends Map */\nclass NounManager {\n  constructor() {\n    this.map = new Map();\n    this.set = this.map.set.bind(this.map);\n    this.get = this.map.get.bind(this.map);\n    this.has = this.map.has.bind(this.map);\n    this.values = this.map.values.bind(this.map);\n    this.clear = this.map.clear.bind(this.map);\n  }\n}\n\nmodule.exports = NounManager;\n\n\n// WEBPACK FOOTER //\n// ./nounManager.js","'use strict';\n/**\n * @module  RoleManager\n */\n\n\n/** @todo  extends Map */\nclass RoleManager {\n\n  constructor() {\n    this.map = new Map();\n    this.set = this.map.set.bind(this.map);\n    this.get = this.map.get.bind(this.map);\n    this.has = this.map.has.bind(this.map);\n    this.values = this.map.values.bind(this.map);\n    this.clear = this.map.clear.bind(this.map);\n  }\n  can(roles, verb, noun) {\n    return roles.map(r => this.get(r) || { can: () => false })\n      .some(r => r.can(verb, noun));\n  }\n}\n\nmodule.exports = RoleManager;\n\n\n// WEBPACK FOOTER //\n// ./roleManager.js","'use strict';\n\nconst RoleManager = require('./roleManager');\n\nmodule.exports = new RoleManager();\n\n\n// WEBPACK FOOTER //\n// ./roles.js","'use strict';\n\n/**\n * @description An angular module that hooks into $stateChangeStart event on UI-Router and lets routes define permissions\n * @example\n * .factory('yourLoginFactory', function(authConfig) {\n *   // on login\n *   authConfig.setUser(yourUser) // <- YOUR USER MUST HAVE CAN METHOD\n * })\n * @module plugins/angular\n */\n\nconst dmv = require('./dmv');\nconst roleManager = require('./roleManager');\nconst canMixin = require('./canMixin');\n\nmodule.exports = angular => {\n  angular.module('dmv', [])\n    .factory('canPlugin', function() {\n      return function(proto) {\n        angular.extend(proto, canMixin);\n      };\n    })\n    .factory('authConfig', ['$rootScope', '$injector', function($rootScope, $injector) {\n      let userGetterMethod = function() {};\n      let asyncUserGetterMethod = function() {};\n      let canGetUserAsync = false;\n\n      const getUser = function() {\n        return $injector.invoke(userGetterMethod);\n      };\n      const getUserAsync = function() {\n        return $injector.invoke(asyncUserGetterMethod);\n      };\n\n      return {\n        getUserAsync: function(fn) {\n          asyncUserGetterMethod = fn;\n          canGetUserAsync = true;\n        },\n        getUser: function(fn) {\n          userGetterMethod = fn;\n\n          $rootScope.can = (verb, noun) => {\n            try {\n              return getUser().can(verb, noun);\n            } catch (e) {\n              return false;\n            }\n          }\n          $rootScope.hasRole = role => {\n            try {\n            return getUser().hasRole(role);\n            } catch (e) {\n              return false;\n            }\n          }\n\n\n          $rootScope.$on('$stateChangeStart', function(event, next) {\n            if (!next || !next.auth) { return; }\n            let user = getUser();\n            if (canGetUserAsync) {\n              user = getUserAsync();\n            }\n            next.resolve = next.resolve || {};\n            next.resolve.dmvAuthPromise = () => Promise.resolve(user)\n              .then(user => {\n                const forbidden = new Error(`You're not authorized to view this page.`);\n                if(next && next.auth) {\n                  if(!user) {\n                    $rootScope.$broadcast('NOT_AUTHENTICATED');\n                    forbidden.status = 401;\n                    throw forbidden;\n                  }\n                  if(next.auth === true) { return; }\n                  if(typeof next.auth === 'function') {\n                    if(!next.auth.call(event, user, next)) {\n                      $rootScope.$broadcast('NOT_AUTHORIZED');\n                      forbidden.status = 403;\n                      throw forbidden;\n                    }\n                    return;\n                  }\n                  for(let verb in next.auth) {\n                    if(next.auth.hasOwnProperty(verb)) {\n                      let noun = next.auth[verb];\n                      if(!user.can(verb, noun)) {\n                        $rootScope.$broadcast('NOT_AUTHORIZED');\n                        forbidden.status = 403;\n                        throw forbidden;\n                      }\n                    }\n                  }\n                }\n\n              });\n          });\n        }\n      };\n\n    }]);\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./angularPlugin.js","'use strict';\n\nconst roles = require('./roles');\n\nconst onPermissionsList = (list, verb, noun) => {\n  return list && !!list.find(item => item.verb === verb && item.noun === noun);\n};\n\n/**\n * Checks if a user has the ability to perform an action on a noun\n * @memberOf plugins/mongoose\n * @param  {string} verb\n * @param  {string} noun\n * @return {boolean}\n */\nexports.can = function(verb, noun) {\n  if(onPermissionsList(this.permissionsWhiteList, verb, noun)) {\n    return true;\n  } else if(onPermissionsList(this.permissionsBlackList, verb, noun)) {\n    return false;\n  } else {\n    return roles.can(this.roles, verb, noun);\n  }\n};\n\n/**\n * Determines if user has role or roles\n * @param  {String|Array}  r role\n * @return {Boolean}\n */\nexports.hasRole = function(r) {\n  if (typeof r === 'string'){\n    return this.roles.indexOf(r) !== -1;\n  } else if (Array.isArray(r)) {\n    return !r.some(role => this.roles.indexOf(role) === -1)\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./canMixin.js"],"sourceRoot":""}